<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>ZY</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="#Lesson 11  ##十四章 ###【10】组合模式我们前面学习了继承的概念，然后又学习了多继承，但是多继承里面有很多的坑，不到逼不得已是不会使用的。那么就有了组合模式来避免这样的问题。 案例如下，水池里面有水和乌龟 1234567891011121314151617181920212223class Turtle(object):    def __init__(self,n):">
<meta property="og:type" content="article">
<meta property="og:title" content="ZY">
<meta property="og:url" content="https://jyue0812.github.io/2018/05/21/python基础11/index.html">
<meta property="og:site_name" content="ZY">
<meta property="og:description" content="#Lesson 11  ##十四章 ###【10】组合模式我们前面学习了继承的概念，然后又学习了多继承，但是多继承里面有很多的坑，不到逼不得已是不会使用的。那么就有了组合模式来避免这样的问题。 案例如下，水池里面有水和乌龟 1234567891011121314151617181920212223class Turtle(object):    def __init__(self,n):">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://jyue0812.github.io/blog/2018/05/21/python基础11/算术.png">
<meta property="og:updated_time" content="2018-03-23T03:56:27.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ZY">
<meta name="twitter:description" content="#Lesson 11  ##十四章 ###【10】组合模式我们前面学习了继承的概念，然后又学习了多继承，但是多继承里面有很多的坑，不到逼不得已是不会使用的。那么就有了组合模式来避免这样的问题。 案例如下，水池里面有水和乌龟 1234567891011121314151617181920212223class Turtle(object):    def __init__(self,n):">
<meta name="twitter:image" content="https://jyue0812.github.io/blog/2018/05/21/python基础11/算术.png">
  
    <link rel="alternate" href="/blog/atom.xml" title="ZY" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/blog/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/" id="logo">ZY</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/blog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://jyue0812.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-python基础11" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2018/05/21/python基础11/" class="article-date">
  <time datetime="2018-05-21T01:02:17.583Z" itemprop="datePublished">2018-05-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>#Lesson 11</p>
<hr>
<p>##十四章</p>
<p>###【10】组合模式<br>我们前面学习了继承的概念，然后又学习了多继承，但是多继承里面有很多的坑，不到逼不得已是不会使用的。那么就有了组合模式来避免这样的问题。</p>
<p>案例如下，水池里面有水和乌龟</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Turtle</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,n)</span>:</span></span><br><span class="line">        self.num = n</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fish</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,n)</span>:</span></span><br><span class="line">        self.num = n</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pool</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,x,y)</span>:</span></span><br><span class="line"></span><br><span class="line">         self.turtle = Turtle(x)</span><br><span class="line">         self.fish = Fish(y)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">echo</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'水池里面有%d只乌龟，%d只小鱼'</span>%(self.turtle.num,self.fish.num))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pool = Pool(<span class="number">1</span>,<span class="number">10</span>)</span><br><span class="line">pool.echo()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#水池里面有1只乌龟，10只小鱼</span></span><br></pre></td></tr></table></figure>
<p>组合模式了就是在类里面调用其它的类，然后加以使用。</p>
<p>###【11】对象属性和类属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="comment"># 这里的属性实际上属于类属性(用类名来调用)</span></span><br><span class="line">    name = <span class="string">"person"</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        <span class="comment">#对象属性</span></span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(Person.name)</span><br><span class="line">per = Person(<span class="string">"tom"</span>)</span><br><span class="line"><span class="comment">#对象属性的优先级高于类属性</span></span><br><span class="line">print(per.name)</span><br><span class="line"><span class="comment">#动态的给对象添加对象属性</span></span><br><span class="line">per.age = <span class="number">18</span><span class="comment">#只针对于当前对象生效，对于类创建的其他对象没有作用</span></span><br><span class="line">print(Person.name)</span><br><span class="line">per2 = Person(<span class="string">"lilei"</span>)</span><br><span class="line"><span class="comment">#print(per2.age)  #没有age属性</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#删除对象中的name属性，在调用会使用到同名的类属性</span></span><br><span class="line"><span class="keyword">del</span> per.name</span><br><span class="line">print(per.name)</span><br><span class="line"></span><br><span class="line"><span class="comment">#注意：以后千万不要讲对象属性与类属性重名，因为对象属性会屏蔽掉类属性。但是当删除对象属性后，在使用又能使用类属性了。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(object)</span>:</span></span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">a = A()</span><br><span class="line">b = A()</span><br><span class="line">c = A()</span><br><span class="line"></span><br><span class="line">print(a.num,b.num,c.num)</span><br><span class="line"></span><br><span class="line">a.num = <span class="number">100</span></span><br><span class="line"></span><br><span class="line">print(a.num,b.num,c.num)</span><br><span class="line"></span><br><span class="line">A.num = <span class="number">1000</span></span><br><span class="line"></span><br><span class="line">print(a.num,b.num,c.num)</span><br><span class="line"></span><br><span class="line"><span class="comment">#0 0 0</span></span><br><span class="line"><span class="comment">#100 0 0</span></span><br><span class="line"><span class="comment">#100 1000 1000</span></span><br></pre></td></tr></table></figure>
<p>这个例子能看出来，对实例对象a的num属性赋值后，就覆盖了原来类对象A的num属性了。</p>
<p>python中在类里面定义的属性是静态变量，相当于C、java、php等语言中的static关键字一样。类的属性是与类对象进行绑定的，并不会依赖任何它的实例对象。任何语言的对象都是这个样的。</p>
<p>###【12】什么是绑定</p>
<p>我们前面刚提到绑定，那是什么是绑定？</p>
<p>python严格按照要 类里面的方法 需要有实例才能被调用，这种限制其实就是python所谓的绑定概念。</p>
<p>我们看个例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setXY</span><span class="params">(self,x,y)</span>:</span></span><br><span class="line">        self.x = x</span><br><span class="line">        self.y = y</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">echoXY</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(self.x,self.y)</span><br><span class="line">a = A()</span><br><span class="line">print(a.__dict__)</span><br><span class="line"></span><br><span class="line">a.setXY(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">print(a.__dict__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> A  <span class="comment">#删除类对象</span></span><br><span class="line"></span><br><span class="line">a.echoXY()</span><br><span class="line"><span class="comment">#b = A()  #类对象删除了，不能再调用了</span></span><br></pre></td></tr></table></figure>
<p>###【13】前方高能：插件方式</p>
<p>利用dict来扩展对象的方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlugIn</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self._exported_methods = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">plugin</span><span class="params">(self, owner)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> self._exported_methods:</span><br><span class="line">            owner.__dict__[f.__name__] = f</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">plugout</span><span class="params">(self, owner)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> self._exported_methods:</span><br><span class="line">            <span class="keyword">del</span> owner.__dict__[f.__name__]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AFeature</span><span class="params">(PlugIn)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        super().__init__()</span><br><span class="line">        self._exported_methods.append(self.get_a_value)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_a_value</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'a feature.'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BFeature</span><span class="params">(PlugIn)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        super().__init__()</span><br><span class="line">        self._exported_methods.append(self.get_b_value)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_b_value</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'b feature.'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Combine</span>:</span> <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = Combine()</span><br><span class="line">AFeature().plugin(c)</span><br><span class="line">BFeature().plugin(c)</span><br><span class="line"></span><br><span class="line">c.get_a_value()</span><br><span class="line">c.get_b_value()</span><br></pre></td></tr></table></figure>
<p>###【14】相关的BIF</p>
<p>类和对象相关的内置函数</p>
<p>####1、issubclass(class,classinfo)</p>
<p>如果第一个参数(class)是第二个参数(classinfo)的子类,则返回True，否则返回False；</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>)第一个类被认定为子类</span><br><span class="line"><span class="number">2</span>）classinfo可以是对象组成的元祖，只要<span class="class"><span class="keyword">class</span>是元祖中任何一个类的子类都返回<span class="title">True</span>。</span></span><br><span class="line"><span class="class">3）在其他情况下报错。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span><span class="params">(A)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">tuple1 = (A,C)</span><br><span class="line">print(issubclass(B,A))</span><br><span class="line"></span><br><span class="line"><span class="comment">#True</span></span><br></pre></td></tr></table></figure>
<p>####2.isinstance(object,classinfo)</p>
<p>如果第一个参数(object)是第二个参数(classinfo)的实例对象，则返回True，否则返回False。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">1</span>)如果objec是classinfo的子类一个实例，也符合条件</span><br><span class="line"><span class="number">2</span>)如果第一个参数不是对象，则永远返回<span class="keyword">False</span>。</span><br><span class="line"><span class="number">3</span>)classinfo可以是类对象组成的元祖。</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span><span class="params">(A)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">tuple1 = (A,C)</span><br><span class="line"></span><br><span class="line">b = B()</span><br><span class="line">print(isinstance(b,tuple1))</span><br><span class="line">print(isinstance(<span class="string">'aas'</span>,str))</span><br><span class="line"></span><br><span class="line"><span class="comment">#True</span></span><br><span class="line"><span class="comment">#True</span></span><br></pre></td></tr></table></figure>
<p>####3.hasattr(object,name)</p>
<p>attr即attribute的缩写，就是属性的意思，下面讲的几个函数都是和对象的属性有关的。</p>
<p>hasatt()的作用是测试一个对象里是否有指定的属性。</p>
<p>第一个参数(object)是对象，第二个参数(name)还属性名(属性的字符串名字)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,x = <span class="number">0</span>)</span>:</span></span><br><span class="line">        self.x = x</span><br><span class="line">c = C()</span><br><span class="line">print(hasattr(c,<span class="string">'x'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#True</span></span><br></pre></td></tr></table></figure>
<p>####4、getattr(object,name[,default])</p>
<p>返回对象指定的属性值，如果指定的属性不存在，则返回default(可选参数)的值；若没有设置default参数，则抛出AttributeError异常。</p>
<p>存在则返回0</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,x = <span class="number">0</span>)</span>:</span></span><br><span class="line">        self.x = x</span><br><span class="line">c = C()</span><br><span class="line">print(getattr(c,<span class="string">'x'</span>))</span><br><span class="line">print(getattr(c,<span class="string">'y'</span>,<span class="string">'你访问的属性不存在'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#0</span></span><br><span class="line"><span class="comment">#你访问的属性不存在</span></span><br></pre></td></tr></table></figure>
<p>####5、setattr(object,name,value)<br>与getattr()相对应，但是setattr()可以设置对象中指定属性的值，如果指定的属性不存在，则会新建属性并赋值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,x = <span class="number">0</span>)</span>:</span></span><br><span class="line">        self.x = x</span><br><span class="line">c = C()</span><br><span class="line"></span><br><span class="line">setattr(c,<span class="string">'x'</span>,<span class="number">1</span>)</span><br><span class="line">print(c.x)</span><br><span class="line"></span><br><span class="line"><span class="comment">#1</span></span><br></pre></td></tr></table></figure>
<p>####6、delattr(object,name)<br>与setattr()相反，delattr()用于删除对象中指定的属性，如果属性不存在则抛出AttributeError异常。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,x = <span class="number">0</span>)</span>:</span></span><br><span class="line">        self.x = x</span><br><span class="line">c = C()</span><br><span class="line"></span><br><span class="line">print(delattr(c,<span class="string">'x'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#None</span></span><br></pre></td></tr></table></figure>
<p>####7、property(fget=None,fset=None,fdel=None,doc=None)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,x = <span class="number">0</span>)</span>:</span></span><br><span class="line">        self.x = x</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getVar</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.x</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setVar</span><span class="params">(self,value)</span>:</span></span><br><span class="line">        self.x = value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">delVar</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">del</span> self.x</span><br><span class="line">    r = property(getVar,setVar,delVar)</span><br><span class="line"></span><br><span class="line">c = C(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">print(c.r)</span><br><span class="line"></span><br><span class="line">c.r = <span class="number">2000</span></span><br><span class="line"></span><br><span class="line">print(c.r)</span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> c.r</span><br></pre></td></tr></table></figure>
<p>property()函数的作用就是可以设置属性的属性，就是给一个属性指定3个方法。</p>
<p>等学完了魔术方法就知道它是怎么运行的了。</p>
<p>##魔术方法(魔法方法)</p>
<p>我们在前面的内容里面已经接触过魔术方法了，比如<code>__init__</code>,<code>__del__</code>,<code>__dict__</code>.</p>
<p>那么什么是魔术方法了？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>)总是被下划线包围</span><br><span class="line"><span class="number">2</span>)魔术方法是加强python的面向对象的</span><br><span class="line"><span class="number">3</span>)它在适当的时候总是能被调用</span><br></pre></td></tr></table></figure>
<p>###【1】<code>__slots__</code>‘属性’</p>
<p><code>__slots__</code>它的作用就是限制类中可以动态添加指定的属性名和方法名。</p>
<p>使用了<code>__slots__</code>后<code>__dict__</code>就不能再使用了，因为<code>__dict__</code>也可以给动态添加类中的属性值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    age = <span class="string">'1'</span></span><br><span class="line">    __slots__ = [<span class="string">'func'</span>,<span class="string">'name'</span>]</span><br><span class="line"></span><br><span class="line">a = A()</span><br><span class="line"></span><br><span class="line">a.name = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">123</span></span><br><span class="line"></span><br><span class="line">a.func = func</span><br><span class="line"></span><br><span class="line">print(a.func())</span><br><span class="line"></span><br><span class="line"><span class="comment">#a.sex = 'male'</span></span><br></pre></td></tr></table></figure>
<p>###【2】<code>__new__(cls[, ...])</code></p>
<p><code>__new__()</code>才是在一个对象实例化的时候第一个调用的方法。它和其它的魔术方法不同，他的第一个参数不是self(本对象），而是这个类本生(cls)，而其它的参数会直接传递给<code>__init__()</code>方法的。</p>
<p><code>__new__()</code>方法需要返回一个实例对象，通常是cls这个类实例化的对象，当然你也可以返回其它对象。</p>
<p><code>__new__</code>方法平时很少去重写它，一般让python用默认的方案去执行它就可以了。一般<code>__new__</code>在整个继承链中有一个就可以了，一种情况下需要重写这个魔术方法，就是集成了一个不可变类型的时候。</p>
<p>如果子类中没有定义new()方法，那么会自动调用其父类的new()方法来制造实例。</p>
<p>而如果新式类中重写了new()方法，那么你可以自由选择任意一个的其他的新式类（必定要是 新式类，只有新式类必定都有new()，因为所有新式类都是object的后代，而经典类则没有new() 方法）的new()方法来制造实例，包括这个新式类的所有前代类和后代类，只要它们不会造成递归死 循环。具体看以下代码解释：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(str)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls,string)</span>:</span></span><br><span class="line">        print(<span class="string">'new'</span>)</span><br><span class="line">        str1 = string.upper()</span><br><span class="line">        <span class="keyword">return</span> str.__new__(cls,str1)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,string)</span>:</span></span><br><span class="line">        print(<span class="string">'ok'</span>)</span><br><span class="line"></span><br><span class="line">a = A(<span class="string">"hello shanghai "</span>)</span><br><span class="line">print(a)</span><br><span class="line"></span><br><span class="line"><span class="comment">#new</span></span><br><span class="line"><span class="comment">#ok</span></span><br><span class="line"><span class="comment">#HELLO SHANGHAI</span></span><br></pre></td></tr></table></figure>
<font color="red">注意：千万不要用自己笨类去调用<code>__new__</code>，这样会死造成循环。</font>

<p>###【3】@property</p>
<p>在绑定属性时，如果我们直接把属性暴露出去，虽然写起来很简单，但是，没办法检查参数，导致可以把类属性随便改；</p>
<p>那么我们就会想到私有属性的定义，私有属性在调用和修改的时候需要加太长的调用规则<code>_类名__属性</code>，这样一来也挺麻烦的，所以我们给每个私有属性定义两个方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myCls</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.__name = <span class="string">'tom'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getName</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.__name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setName</span><span class="params">(self,val)</span>:</span></span><br><span class="line">        self.__name = val</span><br><span class="line"></span><br><span class="line">m = myCls()</span><br><span class="line">print(m.getName())</span><br><span class="line">m.setName(<span class="string">'jack'</span>)</span><br><span class="line">print(m.getName())</span><br></pre></td></tr></table></figure>
<p>还有一种更加简单的方法就是@property</p>
<p>还记得装饰器（decorator）可以给函数动态加上功能吗？对于类的方法，装饰器一样起作用。Python内置的@property装饰器就是负责把一个方法变成属性调用的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myCls</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.__name = <span class="string">'tom'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.__name</span><br><span class="line"></span><br><span class="line"><span class="meta">    @name.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span><span class="params">(self,val)</span>:</span></span><br><span class="line">        self.__name = val</span><br><span class="line"></span><br><span class="line">m = myCls()</span><br><span class="line">print(m.name)</span><br><span class="line">m.name = <span class="string">'jack'</span></span><br><span class="line">print(m.name)</span><br></pre></td></tr></table></figure>
<p>注意到这个神奇的@property，我们在对实例属性操作的时候，就知道该属性很可能不是直接暴露的，而是通过getter和setter方法来实现的。</p>
<p>还可以定义只读属性，只定义getter方法，不定义setter方法就是一个只读属性：</p>
<p>@property的实现比较复杂，我们先考察如何使用。把一个getter方法变成属性，只需要加上@property就可以了，此时，@property本身又创建了另一个装饰器@score.setter，负责把一个setter方法变成属性赋值，于是，我们就拥有一个可控的属性操作：</p>
<p>###【4】工厂函数</p>
<p>现在有一个新的名词需要大家记住：工厂函数，大家现在可能没听过，但是我们早就接触到了，知识那个时候我们还没有学习过类和对象，那个时候说了也白说。</p>
<p>python2.2以后，对类和类型进行了统一，做法就是将int()、float()、str()、list()这些转换为工厂函数。</p>
<p>我们看个例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">print(type(len))</span><br><span class="line">print(type(dir))</span><br><span class="line">print(type(list))</span><br><span class="line">print(type(int))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#&lt;class 'builtin_function_or_method'&gt;</span></span><br><span class="line"><span class="comment">#&lt;class 'builtin_function_or_method'&gt;</span></span><br><span class="line"><span class="comment">#&lt;class 'type'&gt;</span></span><br><span class="line"><span class="comment">#&lt;class 'type'&gt;</span></span><br></pre></td></tr></table></figure>
<p>普通的BIF应该是<class 'builtin_function_or_method'="">，而工厂函数是<class 'type'="">，大家有没有很眼熟，在哪里见过。</class></class></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">print(type(A))</span><br><span class="line"></span><br><span class="line"><span class="comment">#&lt;class 'type'&gt;</span></span><br></pre></td></tr></table></figure>
<p>它也是type类型，也就是类对象，也就是所谓的工厂函数，那么工厂函数就是一个类对象，当调用类对象的时候，它返回的是一个实例对象：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = int(<span class="string">'123'</span>)</span><br><span class="line">b = int(<span class="string">'345'</span>)</span><br><span class="line">print(a+b)</span><br><span class="line"></span><br><span class="line"><span class="comment">#468</span></span><br></pre></td></tr></table></figure>
<p>当在求a + b等于多少的时候，事实上python就是讲两个对象进行相加操作。</p>
<p>现在是不是豁然开朗，原来实例对象是可以进行运算的！其实早该发现这个问题了，python中无处不对象。</p>
<p>###【5】算术运算符</p>
<p>python的魔术方法还提供了自定义对象的数值处理，通过对下面这些魔术方法的重写，可以自定义任何对象的算术运算。</p>
<p> <img src="/blog/2018/05/21/python基础11/算术.png" alt="算术"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#不同的类型用加法会有不同的解释</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_int</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, num)</span>:</span></span><br><span class="line">        self.num = num</span><br><span class="line">    <span class="comment">#运算符重载</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__add__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> _int(self.num + other.num)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"num = "</span> + str(self.num)</span><br><span class="line">per1 = _int(<span class="number">1</span>)</span><br><span class="line">per2 = _int(<span class="number">2</span>)</span><br><span class="line">print(per1 + per2)<span class="comment">#per1 + per2 ==== per1.__add__(per2)</span></span><br><span class="line"><span class="comment">#print(per1.__add__(per2))</span></span><br><span class="line">print(per1)</span><br><span class="line">print(per2)</span><br><span class="line"></span><br><span class="line"><span class="comment">#num = 3</span></span><br><span class="line"><span class="comment">#num = 1</span></span><br><span class="line"><span class="comment">#num = 2</span></span><br></pre></td></tr></table></figure>
<font color="red">注意下面的例子：</font>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_int</span><span class="params">(int)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__add__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self + other</span><br><span class="line"></span><br><span class="line">a = _int(<span class="number">1</span>)</span><br><span class="line">b = _int(<span class="number">2</span>)</span><br><span class="line">print(a+b)</span><br><span class="line"></span><br><span class="line"><span class="comment">#RecursionError: maximum recursion depth exceeded while calling a Python object</span></span><br></pre></td></tr></table></figure>
<p>看这个例子，变成了无限递归，为什么？注意add里面，写的是 <code>return self + other</code>，self代表这个类，每次都会调用<code>__add__</code>方法，这样就变成死递归了。怎么解决？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_int</span><span class="params">(int)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__add__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> int(self) + other</span><br><span class="line"></span><br><span class="line">a = _int(<span class="number">1</span>)</span><br><span class="line">b = _int(<span class="number">4</span>)</span><br><span class="line">print(a+b)</span><br><span class="line"></span><br><span class="line"><span class="comment">#5</span></span><br></pre></td></tr></table></figure>
<p>###【7】短信接口</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#接口类型 秒嘀科技 短信验证码</span></span><br><span class="line"><span class="comment">#账户注册 http://www.miaodiyun.com</span></span><br><span class="line"><span class="comment">#注意事项：</span></span><br><span class="line"><span class="comment">#（1）调用期间要在 秒嘀的控制台 添加好短信模板</span></span><br><span class="line"><span class="comment">#（2）ACCOUNT SID和AUTH TOKEN 在 控制台-&gt;用户中心-&gt;账户管理-&gt;开发者中心查看</span></span><br><span class="line"><span class="comment">#（3）该代码仅供接入秒嘀科技验证码短信接口参考使用，如若接入其它公司短信产品要按照该产品规定；</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">格式拼接</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">accountSid = a14f6bfd43ce44c9b019de57f4e2de4b &amp; smsContent =【秒嘀科技】您的验证码是345678，30</span></span><br><span class="line"><span class="string">分钟输入有效。</span></span><br><span class="line"><span class="string">&amp; to = 13896543210 &amp; timestamp = 20150821100312 &amp; sig = a14f6bfd43ue44c9b019du57f4e2ee4r &amp; respDataType = JSON</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> http <span class="keyword">import</span> client</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request,parse</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sendSMs</span>:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,to = str<span class="params">(<span class="number">17621044208</span>)</span>)</span>:</span></span><br><span class="line">        self.accountSid = <span class="string">'43ca172021e8420fbbda5741d097c37d'</span></span><br><span class="line">        self.authToken  = <span class="string">'97c65cbf25ee4602806edf8eb01771e6'</span></span><br><span class="line">        self.verificationCode = randint(<span class="number">999</span>,<span class="number">10000</span>)</span><br><span class="line">        self.smsContent = <span class="string">'【仁雨科技】尊敬的用户，您正在进行登陆验证，您的验证码为：&#123;%d&#125;,有效时间为3分钟。为了您的信息安全，请妥善保管好您的验证码。'</span>%self.verificationCode</span><br><span class="line">        self.to = to</span><br><span class="line">        self.timestamp = time.strftime(<span class="string">"%Y%m%d%H%M%S"</span>, time.localtime())</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encryption</span><span class="params">(self)</span>:</span></span><br><span class="line"></span><br><span class="line">        self.sig = self.accountSid + self.authToken +self.timestamp</span><br><span class="line">        md5 = hashlib.md5()</span><br><span class="line">        md5.update(self.sig.encode(<span class="string">'utf-8'</span>))  <span class="comment"># 注意转码</span></span><br><span class="line">        self.sig = md5.hexdigest()</span><br><span class="line">        self.respDataType  = <span class="string">'JSON'</span></span><br><span class="line">        <span class="keyword">del</span> self.verificationCode,self.authToken  <span class="comment">#这两个就没有用了</span></span><br><span class="line">        sDict = self.__dict__</span><br><span class="line">        params = parse.urlencode(sDict)</span><br><span class="line">        <span class="keyword">return</span> params</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sendMsg</span><span class="params">(self)</span>:</span></span><br><span class="line">        host = <span class="string">'api.miaodiyun.com'</span></span><br><span class="line">        postUrl = <span class="string">'/20150822/industrySMS/sendSMS'</span></span><br><span class="line">        headers = &#123;<span class="string">"Content-type"</span>: <span class="string">"application/x-www-form-urlencoded;charset:utf-8;"</span>, <span class="string">"Accept"</span>: <span class="string">"text/plain"</span>&#125;</span><br><span class="line">        connect = client.HTTPConnection(host,port = <span class="number">80</span>,timeout=<span class="number">30</span>)</span><br><span class="line">        params = self.encryption()</span><br><span class="line">        a=connect.request(<span class="string">"POST"</span>, postUrl, params, headers)</span><br><span class="line">        response = connect.getresponse()</span><br><span class="line">        response_str = response.read()</span><br><span class="line">        connect.close()</span><br><span class="line">        <span class="keyword">return</span> response_str</span><br><span class="line"></span><br><span class="line">s = sendSMs(<span class="number">18626070896</span>)</span><br><span class="line">print(s.sendMsg())</span><br></pre></td></tr></table></figure>
<p>###【8】发送邮件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> smtplib</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> email.mime.text <span class="keyword">import</span> MIMEText</span><br><span class="line"><span class="keyword">from</span> email.mime.multipart <span class="keyword">import</span> MIMEMultipart</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SendMail</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, message = <span class="string">'用户'</span>, title = <span class="string">'仁雨科技'</span>, to = [<span class="string">'this_my_email@126.com'</span>])</span>:</span></span><br><span class="line">        <span class="comment"># SMTP服务器</span></span><br><span class="line">        self.SMTPServer = <span class="string">"smtp.126.com"</span></span><br><span class="line">        <span class="comment"># 发邮件的地址</span></span><br><span class="line">        self.sender = <span class="string">"this_my_email@126.com"</span></span><br><span class="line">        <span class="comment"># 发送者邮箱的密码</span></span><br><span class="line">        self.passwd = <span class="string">"rd911123"</span></span><br><span class="line">        <span class="comment">#指定的信息(某某用户)</span></span><br><span class="line">        self.message = message</span><br><span class="line">        <span class="comment">#邮件的标题</span></span><br><span class="line">        self.title = title</span><br><span class="line">        <span class="comment">#发送给谁</span></span><br><span class="line">        <span class="keyword">if</span> isinstance(to,list):</span><br><span class="line">            self.to = to</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'请输入list类型'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_html</span><span class="params">(self)</span>:</span></span><br><span class="line">        message = <span class="string">'''</span></span><br><span class="line"><span class="string">            &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">            &lt;html lang="zh-CN"&gt;</span></span><br><span class="line"><span class="string">              &lt;head&gt;</span></span><br><span class="line"><span class="string">                &lt;meta charset="utf-8"&gt;</span></span><br><span class="line"><span class="string">                &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;</span></span><br><span class="line"><span class="string">                &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;</span></span><br><span class="line"><span class="string">                &lt;!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！--&gt;</span></span><br><span class="line"><span class="string">                &lt;title&gt;Bootstrap 101 Template&lt;/title&gt;</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">                &lt;!-- Bootstrap --&gt;</span></span><br><span class="line"><span class="string">                &lt;!--&lt;link href="http://www.mantoman.cn/static/bootstrap/css/bootstrap.min.css" rel="stylesheet"&gt;--&gt;</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">                &lt;!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries --&gt;</span></span><br><span class="line"><span class="string">                &lt;!-- WARNING: Respond.js doesn't work if you view the page via file:// --&gt;</span></span><br><span class="line"><span class="string">                &lt;!--[if lt IE 9]&gt;</span></span><br><span class="line"><span class="string">                  &lt;script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">                  &lt;script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">                &lt;![endif]--&gt;</span></span><br><span class="line"><span class="string">              &lt;/head&gt;</span></span><br><span class="line"><span class="string">              &lt;body&gt;</span></span><br><span class="line"><span class="string">                &lt;div style="padding-left:100px;padding-top:48px;padding-bottom:48px;margin-bottom: 30px;color: inherit;background-color: #eee;box-sizing: border-box;display: block;font-size: 14px;line-height: 1.42857143;"&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class="container"&gt;</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">                        &lt;h1&gt;仁雨科技邮箱验证!&lt;/h1&gt;</span></span><br><span class="line"><span class="string">                        &lt;h3&gt;尊敬的%s，感谢您在仁雨科技注册帐户！激活帐户需要点击下面的链接!&lt;/h3&gt;</span></span><br><span class="line"><span class="string">                        &lt;p&gt;&lt;a class="btn btn-primary btn-lg" role="button" href="http://www.baidu.com" style='padding: 10px 16px;font-size: 18px;line-height: 1.3333333;border-radius: 6px;color: #fff;background-color: #337ab7;border-color: #2e6da4;display: inline-block;margin-bottom: 0;text-align: center;white-space: nowrap;touch-action: manipulation;cursor: pointer;vertical-align: middle;user-select: none;background-image: none;border: 1px solid transparent;text-decoration: none;box-sizing: border-box;-webkit-tap-highlight-color: rgba(0,0,0,0);box-sizing: border-box;'&gt;</span></span><br><span class="line"><span class="string">                         百度&lt;/a&gt;</span></span><br><span class="line"><span class="string">                        &lt;/p&gt;</span></span><br><span class="line"><span class="string">                        &lt;br /&gt;</span></span><br><span class="line"><span class="string">                        &lt;h3&gt;Python改变世界！&lt;/h3&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">              &lt;/body&gt;</span></span><br><span class="line"><span class="string">                &lt;!-- jQuery (necessary for Bootstrap's JavaScript plugins) --&gt;</span></span><br><span class="line"><span class="string">                &lt;script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">                &lt;!-- Include all compiled plugins (below), or include individual files as needed --&gt;</span></span><br><span class="line"><span class="string">                &lt;script src="js/bootstrap.min.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">            &lt;/html&gt;</span></span><br><span class="line"><span class="string">        '''</span>%self.message</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> message</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sendmail</span><span class="params">(self)</span>:</span></span><br><span class="line">        msg = self._html()</span><br><span class="line">        <span class="comment">#转换成邮件文本</span></span><br><span class="line">        msg = MIMEText(msg,<span class="string">'html'</span>,<span class="string">'utf-8'</span>)</span><br><span class="line">        <span class="comment">#邮件的标题</span></span><br><span class="line">        msg[<span class="string">"Subject"</span>] = self.title</span><br><span class="line">        <span class="comment">#发送者信息</span></span><br><span class="line">        msg[<span class="string">'From'</span>] = self.sender</span><br><span class="line">        <span class="comment"># 创建SMTP服务器</span></span><br><span class="line">        mailServer = smtplib.SMTP(self.SMTPServer, <span class="number">25</span>)</span><br><span class="line">        <span class="comment"># 登陆邮箱</span></span><br><span class="line">        mailServer.login(self.sender, self.passwd)</span><br><span class="line">        <span class="comment"># 发送邮件</span></span><br><span class="line">        mailServer.sendmail(self.sender, self.to, msg.as_string())</span><br><span class="line">        <span class="comment"># 退出邮箱</span></span><br><span class="line">        mailServer.quit()</span><br><span class="line"></span><br><span class="line">s = SendMail()</span><br><span class="line">s.sendmail()</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://jyue0812.github.io/2018/05/21/python基础11/" data-id="cjhfjx3dr0008w4qxlmgw3s74" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/blog/2018/05/21/python基础12/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/blog/2018/05/21/python基础10/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/04/">April 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2018/06/19/2018-06-19/">(no title)</a>
          </li>
        
          <li>
            <a href="/blog/2018/06/05/flask配置套路/">(no title)</a>
          </li>
        
          <li>
            <a href="/blog/2018/06/04/2018-06-04/">(no title)</a>
          </li>
        
          <li>
            <a href="/blog/2018/05/21/jquery_3/">(no title)</a>
          </li>
        
          <li>
            <a href="/blog/2018/05/21/pymysql/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 ZY<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">Home</a>
  
    <a href="/blog/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css">
  <script src="/blog/fancybox/jquery.fancybox.pack.js"></script>


<script src="/blog/js/script.js"></script>



  </div>
</body>
</html>