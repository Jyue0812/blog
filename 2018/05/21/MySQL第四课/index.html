<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>ZY</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Lesson_4MySql1.union联合查询12345678910将多个select语句的结果纵向组合select * from stuinfo union select * from stuinfoo;union:1.all #显示全部记录2.distinct  #(去除重复的值  他是默认)select * from stuinfo union all select * from stui">
<meta property="og:type" content="article">
<meta property="og:title" content="ZY">
<meta property="og:url" content="https://jyue0812.github.io/2018/05/21/MySQL第四课/index.html">
<meta property="og:site_name" content="ZY">
<meta property="og:description" content="Lesson_4MySql1.union联合查询12345678910将多个select语句的结果纵向组合select * from stuinfo union select * from stuinfoo;union:1.all #显示全部记录2.distinct  #(去除重复的值  他是默认)select * from stuinfo union all select * from stui">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-05-21T01:05:36.586Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ZY">
<meta name="twitter:description" content="Lesson_4MySql1.union联合查询12345678910将多个select语句的结果纵向组合select * from stuinfo union select * from stuinfoo;union:1.all #显示全部记录2.distinct  #(去除重复的值  他是默认)select * from stuinfo union all select * from stui">
  
    <link rel="alternate" href="/blog/atom.xml" title="ZY" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/blog/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/" id="logo">ZY</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/blog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://jyue0812.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-MySQL第四课" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2018/05/21/MySQL第四课/" class="article-date">
  <time datetime="2018-05-21T01:05:31.316Z" itemprop="datePublished">2018-05-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Lesson-4"><a href="#Lesson-4" class="headerlink" title="Lesson_4"></a>Lesson_4</h1><h1 id="MySql"><a href="#MySql" class="headerlink" title="MySql"></a>MySql</h1><h2 id="1-union联合查询"><a href="#1-union联合查询" class="headerlink" title="1.union联合查询"></a>1.union联合查询</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">将多个select语句的结果纵向组合</span><br><span class="line"></span><br><span class="line">select * from stuinfo union select * from stuinfoo;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">union:</span><br><span class="line">1.all #显示全部记录</span><br><span class="line">2.distinct  #(去除重复的值  他是默认)</span><br><span class="line"></span><br><span class="line">select * from stuinfo union all select * from stuinfoo;</span><br></pre></td></tr></table></figure>
<p>查找北京的女生和上海的男生  <code>[晚上自己写一篇或多编]</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from stuinfo where (city=&apos;上海&apos; and sex=&apos;male&apos;) or (city=&apos;北京&apos; and sex=&apos;female&apos;);</span><br><span class="line"></span><br><span class="line">select * from stuinfo having city=&apos;上海&apos; and sex=&apos;male&apos; union all select * from stuinfo having city=&apos;北京&apos; and sex=&apos;female&apos;;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Union的要求:</span><br><span class="line">1.两边的select语句的字段数要一致</span><br><span class="line">2,字段名可以不一样,最终按照第一个select语句的字段名返回</span><br><span class="line">3.两边可以具有相同或不同的数据类型</span><br></pre></td></tr></table></figure>
<p>男生的年龄降序,女生的年龄升序    <code>[ 晚上自己写一篇或多编]</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(select * from stuinfo having sex=1 order by age desc limit 1000) union all (select * from stuinfo having sex=2 order by age asc limit 1000);</span><br></pre></td></tr></table></figure>
<h2 id="2-多表查询"><a href="#2-多表查询" class="headerlink" title="2.多表查询"></a>2.多表查询</h2><h3 id="1-分类"><a href="#1-分类" class="headerlink" title="(1)分类"></a>(1)分类</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.内连接</span><br><span class="line">2.外连接</span><br><span class="line">	a.左外连接</span><br><span class="line">	b.右外连接</span><br><span class="line">3.交叉连接</span><br><span class="line">4.自然连接</span><br></pre></td></tr></table></figure>
<h3 id="2-内连接-inner-join"><a href="#2-内连接-inner-join" class="headerlink" title="(2)内连接(inner join)"></a>(2)内连接(inner join)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#查询学生信息</span><br><span class="line">select * from stuinfo inner join stumarks on stuinfo.sid = stumarks.stuno;</span><br><span class="line">#inner 可以不用写</span><br><span class="line">#给表取别名的 as 也可以省略不写</span><br><span class="line">select * from stuinfo a join stumarks b on a.sid = b.stuno;</span><br><span class="line"></span><br><span class="line">#inner join数据不完整就不显示</span><br><span class="line"></span><br><span class="line">大坑别踩:</span><br><span class="line"></span><br><span class="line">表连接肯定经常要用,如果你查询单条数据,而这条数据的从表信息不完整,使用内链接,查询出的结果为空,</span><br><span class="line">但是,python代码的写法是一致的,为了避免python报错,基本不使用内链接.</span><br></pre></td></tr></table></figure>
<h3 id="3-外连接"><a href="#3-外连接" class="headerlink" title="(3)外连接"></a>(3)外连接</h3><h4 id="a-左外连接-left-join"><a href="#a-左外连接-left-join" class="headerlink" title="a.左外连接(left  join)"></a>a.左外连接(left  join)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from stuinfo a left join stumarks b on a.sid=b.sid;</span><br><span class="line">#以左边的表为准,右边表中没有的记录用null表示</span><br></pre></td></tr></table></figure>
<h4 id="b-右外连接-right-join"><a href="#b-右外连接-right-join" class="headerlink" title="b.右外连接(right join)"></a>b.右外连接(right join)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from stuinfo a right join stumarks b on a.sid=b.sid;</span><br><span class="line">##以右边的表为准,左边表中没有的记录用null表示</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">思考:</span><br><span class="line">select * from 表一 inner join 表二 on 表一.公共字段=表二.公共字段;</span><br><span class="line">select * from 表二 inner join 表一 on 表二.公共字段=表一.公共字段;</span><br><span class="line"></span><br><span class="line">select * from 表一 left join 表二 on 表一.公共字段=表二.公共字段;</span><br><span class="line">select * from 表一 right join 表二 on 表一.公共字段=表二.公共字段;</span><br><span class="line"></span><br><span class="line">select * from 表一 left join 表二 on 表一.公共字段=表二.公共字段;</span><br><span class="line">select * from 表二 right join 表一 on 表二.公共字段=表一.公共字段;</span><br></pre></td></tr></table></figure>
<h3 id="4-交叉连接-cross-join"><a href="#4-交叉连接-cross-join" class="headerlink" title="(4)交叉连接(cross join)"></a>(4)交叉连接(cross join)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#交叉连接返回的结果和内链接一样的</span><br><span class="line">select * from stuinfo a cross join stumarks b on a.sid=b.stuno;</span><br><span class="line">select * from  stuinfo,stumarks;</span><br></pre></td></tr></table></figure>
<h3 id="5-自然连接-natural"><a href="#5-自然连接-natural" class="headerlink" title="(5)自然连接(natural)"></a>(5)自然连接(natural)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">1.natural join #自然内连接</span><br><span class="line">2.natural left join #自然左外连接</span><br><span class="line">3.natural right join #自然右外连接</span><br><span class="line"></span><br><span class="line">select * from stuinfo a natural join stumarks b;</span><br><span class="line">select * from stuinfo a natural left join stumarks b;</span><br><span class="line">select * from stuinfo a natural right join stumarks b;</span><br><span class="line"></span><br><span class="line">结论:</span><br><span class="line">1.自动判断连接条件,依据的是同名字段名</span><br><span class="line">2.如果没有同名的字段名返回的是笛卡尔积</span><br><span class="line">3.自动返回结果并进行整理;</span><br><span class="line">	a.连接字段最好保留一个</span><br><span class="line">	b.连接字段最好放在最前面</span><br></pre></td></tr></table></figure>
<h3 id="6-using"><a href="#6-using" class="headerlink" title="(6)using"></a>(6)using</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#指定连接字段,using也会查询出的结果进行整理,整理的方式和自然连接相同.</span><br><span class="line"></span><br><span class="line">select * from stuinfo left join stumarks using(sid);</span><br></pre></td></tr></table></figure>
<h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1.显示地区和每个地区参加数学考试的人数,并且按人数降序排列</span><br><span class="line">select a.city,count(b.math)  c from stuinfo a left join stumarks b using(sid) group by city order by c desc;</span><br><span class="line"></span><br><span class="line">2..显示男生人数和女生人数</span><br><span class="line">select a.sex,count(a.sex) from stuinfo a group by sex;</span><br><span class="line"></span><br><span class="line">select sex,count(sex) from stuinfo where sex=1 union select sex,count(sex) from stuinfo where sex=2;</span><br><span class="line"></span><br><span class="line">select sum(sex=1) 男,sum(sex=2) 女 from stuinfo;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3.显示每个地区的男生人数,女生人数,总人数</span><br><span class="line">select city 城市,count(sex) 总人数,sum(sex=&apos;male&apos;) 男, sum(sex=&apos;female&apos;) 女 from stuinfo group by city;</span><br></pre></td></tr></table></figure>
<h2 id="3-子查询"><a href="#3-子查询" class="headerlink" title="3.子查询"></a>3.子查询</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">什么叫子查询?</span><br><span class="line">查询语句中还有查询语句,外面的查询称为父查询,里面的叫子查询.</span><br><span class="line">子查询为父查询提供查询条件.</span><br><span class="line"></span><br><span class="line">例题:查询数学成绩是80分的学生</span><br><span class="line">#普通的查询</span><br><span class="line">select * from stumarks left join stuinfo using(sid) where math=80;</span><br><span class="line">#子查询</span><br><span class="line">select * from stuinfo where sid=(select sid from stumarks where math = 80);</span><br><span class="line">#如果使用等于,那就必须确保子查询查到的结果只有一个</span><br><span class="line">#子查询的结果只能是单一的字段</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">例题:查找数学最高分的学生</span><br><span class="line">#普通的查询</span><br><span class="line">select a.sid,a.sname,a.sex,a.age,a.city,max(b.math) from stuinfo a left join stumarks b using(sid);#问题 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#子查询</span><br><span class="line">select * from  stuinfo where sid = (select sid from stumarks where math = (select max(math) from stumarks));</span><br></pre></td></tr></table></figure>
<h3 id="1-in-not-in"><a href="#1-in-not-in" class="headerlink" title="(1)in|not in"></a>(1)in|not in</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">如果子查询中返回了多条记录,使用 = 会发生错误,那么就必须要用in</span><br><span class="line"></span><br><span class="line">例题:查询数学成绩不及格的学生</span><br><span class="line"> select * from stuinfo where sid in (select sid from stumarks where math in (select math from stumarks having math&lt;60));</span><br><span class="line"></span><br><span class="line">#1.数学成绩不及格 &lt;60 60种可能</span><br><span class="line">select math from stumarks having math&lt;60; #查询到的有可能是一个也有可能是多个(58,59)</span><br><span class="line">#2.这些成绩是那些学生的(sid)</span><br><span class="line">select sid from stumarks where math in (58,59);   #(3,4)</span><br><span class="line">#3.根据学号查找学生的信息</span><br><span class="line"> select * from stuinfo where sid in (3,4);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">例题:查询没有参加考试的学生</span><br><span class="line">select * from stuinfo where sid in (select sid from stumarks where math is null);</span><br></pre></td></tr></table></figure>
<h3 id="2-some-any-all"><a href="#2-some-any-all" class="headerlink" title="(2)some | any|all"></a>(2)some | any|all</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">some和any是一样的,表示一些,类似与 in</span><br><span class="line">all 表示全部的元素</span><br><span class="line">#some</span><br><span class="line">select * from stuinfo where sid =some (select sid from stumarks where math&lt;60);</span><br><span class="line"></span><br><span class="line">select *from stuinfo where sid =any (select sid from stumarks where math&lt;60);</span><br><span class="line"></span><br><span class="line">#条件都满足</span><br><span class="line">select * from stuinfo where sid =all (select sid from stumarks where math&lt;60);</span><br><span class="line"></span><br><span class="line">查询数学90分以上的学生</span><br><span class="line">select * from  stuinfo where sid not in (select sid from stumarks where math&lt;90);</span><br><span class="line"></span><br><span class="line">select * from  stuinfo where sid != some (select sid from stumarks where math&lt;90);</span><br><span class="line">#some = in  !=some不等与 not in</span><br><span class="line">#!=all 等同 not in</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">查询数学90以下的学生</span><br><span class="line">select * from  stuinfo where sid =some (select sid from stumarks where math in(select math from stumarks having math&lt;90));</span><br></pre></td></tr></table></figure>
<h3 id="3-exists-not-exists"><a href="#3-exists-not-exists" class="headerlink" title="(3)exists | not exists"></a>(3)exists | not exists</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">如果有人math超过100分,就显示所有学生的信息</span><br><span class="line">select * from stuinfo where exists(select * from stumarks where math&gt;=100);</span><br><span class="line">#成绩未达到100分就显示</span><br><span class="line">select * from stuinfo where not exists(select * from stumarks where math&gt;=100);</span><br></pre></td></tr></table></figure>
<h3 id="4-子查询分类"><a href="#4-子查询分类" class="headerlink" title="(4)子查询分类"></a>(4)子查询分类</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1.标量子查询:子查询返回的值只有一个 sid = </span><br><span class="line">2.列子查询:子查询返回一个列表 sid in (3,4)</span><br><span class="line">3.行子查询:查询多个条件由多个字段组成的行形成</span><br><span class="line"></span><br><span class="line">找出语文成绩最高的男生和女生:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select * from stuinfo where sid in (select sid from stumarks where ch in ( select max(ch) from stuinfo left join stumarks using(sid) group by sex));</span><br></pre></td></tr></table></figure>
<h2 id="4-视图"><a href="#4-视图" class="headerlink" title="4.视图"></a>4.视图</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.视图是一张虚拟的表,他表示一张表的部分数据或多张表的综合数据,</span><br><span class="line">视图的结构是建立在表的基础上</span><br><span class="line">2.视图中没有数据,只有表结构,视图中的数据在基表中获取</span><br><span class="line">3.一张表可以创建多个视图,一个视图可以引用多张表</span><br></pre></td></tr></table></figure>
<h3 id="1-创建视图"><a href="#1-创建视图" class="headerlink" title="(1)创建视图"></a>(1)创建视图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create [or replace] view `视图名`</span><br><span class="line">as</span><br><span class="line">sql语句</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create view stu_view_1</span><br><span class="line">as</span><br><span class="line">select sid,sname,age,sex,city,ch,math from stuinfo left join stumarks using(sid);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#视图创建完毕后,会在对应的文件夹中保存一个.frm的文件,子文件是视图的结构</span><br></pre></td></tr></table></figure>
<h3 id="2-查询"><a href="#2-查询" class="headerlink" title="(2)查询"></a>(2)查询</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from `stu_view_1`;</span><br></pre></td></tr></table></figure>
<h3 id="3-修改视图"><a href="#3-修改视图" class="headerlink" title="(3)修改视图"></a>(3)修改视图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alter view stu_view_1</span><br><span class="line">as</span><br><span class="line">select * from stuinfo;</span><br></pre></td></tr></table></figure>
<h3 id="4-查看视图的信息"><a href="#4-查看视图的信息" class="headerlink" title="(4)查看视图的信息"></a>(4)查看视图的信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">show create view stu_view_1\G</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; show create view stu_view_1\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">                View: stu_view_1</span><br><span class="line">         Create View: CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL</span><br><span class="line">SECURITY DEFINER VIEW `stu_view_1` AS select `stuinfo`.`sid` AS `sid`,`stuinfo`.</span><br><span class="line">`sname` AS `sname`,`stuinfo`.`sex` AS `sex`,`stuinfo`.`age` AS `age`,`stuinfo`.`</span><br><span class="line">city` AS `city` from `stuinfo`</span><br><span class="line">character_set_client: gbk</span><br><span class="line">collation_connection: gbk_chinese_ci</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h3 id="5-查看视图的结构"><a href="#5-查看视图的结构" class="headerlink" title="(5)查看视图的结构"></a>(5)查看视图的结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">desc stu_view_1;</span><br><span class="line"></span><br><span class="line">mysql&gt; desc stu_view_1;</span><br><span class="line">+-------+-----------------------+------+-----+---------+-------+</span><br><span class="line">| Field | Type                  | Null | Key | Default | Extra |</span><br><span class="line">+-------+-----------------------+------+-----+---------+-------+</span><br><span class="line">| sid   | int(11)               | NO   |     | 0       |       |</span><br><span class="line">| sname | varchar(255)          | YES  |     | NULL    |       |</span><br><span class="line">| sex   | enum(&apos;male&apos;,&apos;female&apos;) | YES  |     | NULL    |       |</span><br><span class="line">| age   | tinyint(4)            | YES  |     | NULL    |       |</span><br><span class="line">| city  | varchar(64)           | YES  |     | NULL    |       |</span><br><span class="line">+-------+-----------------------+------+-----+---------+-------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<h3 id="6-查找视图"><a href="#6-查找视图" class="headerlink" title="(6)查找视图;"></a>(6)查找视图;</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">show tables;#它也可以查看视图</span><br><span class="line"></span><br><span class="line">select table_name from information_schema.views;</span><br><span class="line"></span><br><span class="line">show table status where comment=&apos;view&apos;\G;</span><br></pre></td></tr></table></figure>
<h3 id="7-删除视图"><a href="#7-删除视图" class="headerlink" title="(7)删除视图"></a>(7)删除视图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop view stu_view_1;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">找出语文成绩最高的男生和女生:</span><br><span class="line">select * from stu_view_1 where(sex,ch) in (select sex,max(ch)from stu_view_1 group by sex);</span><br><span class="line">#把查询当作是数据源,命名为t</span><br><span class="line">select * from (select * from stu_view_1 order by ch desc) t group by sex;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create view vw_1</span><br><span class="line">as</span><br><span class="line">select * from stu_view_1 order by ch desc;</span><br></pre></td></tr></table></figure>
<h3 id="8-视图算法理论"><a href="#8-视图算法理论" class="headerlink" title="(8)视图算法理论"></a>(8)视图算法理论</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1.merge:合并算法(将视图语句与外层语句合并执行)</span><br><span class="line">2.temptable:临时表算法(将视图执行的结果作为一个临时表,再执行外层语句)</span><br><span class="line">3.undefined:未定义算法,由mysql自己决定,一般使用的都是merge</span><br><span class="line"></span><br><span class="line">#给视图指定算法</span><br><span class="line">create or replace algorithm=merge view vm_2</span><br><span class="line">as</span><br><span class="line">select * from stuinfo order by sid desc;</span><br></pre></td></tr></table></figure>
<h3 id="5-事务"><a href="#5-事务" class="headerlink" title="5.事务"></a>5.事务</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">什么是事务?</span><br><span class="line">1.事务是一个不可拆分的工作单元;</span><br><span class="line">2.事务是作为一个整体向系统提交的,要么一起执行,要么一起不执行;</span><br><span class="line">3.事务是不支持嵌套的</span><br></pre></td></tr></table></figure>
<h3 id="1-事务的特性"><a href="#1-事务的特性" class="headerlink" title="(1)事务的特性"></a>(1)事务的特性</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.原子性:不可拆分</span><br><span class="line">2.一致性:要么一起执行,要么一起不执行</span><br><span class="line">3.隔离性:事务彼此没关系</span><br><span class="line">4.永久性:一旦执行成功,不可修改</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#事务先要开启</span><br><span class="line">start transaction;</span><br><span class="line">#语句</span><br><span class="line">insert into stuinfo values(null,&apos;百强&apos;,1,18,&apos;黑龙江&apos;);</span><br><span class="line">insert into stuinfo values(null,&apos;百强1&apos;,2,18,&apos;黑龙江&apos;);</span><br><span class="line">insert into stuinfo values(null,&apos;百强2&apos;,3,18,&apos;黑龙江&apos;);</span><br><span class="line">#不成功回滚</span><br><span class="line">rollback;</span><br><span class="line">#成功-&gt;提交</span><br><span class="line">commit;</span><br><span class="line"></span><br><span class="line">#注意</span><br><span class="line">事务只能在innodb引擎下使用</span><br></pre></td></tr></table></figure>
<h3 id="2-自动提交事务"><a href="#2-自动提交事务" class="headerlink" title="(2)自动提交事务"></a>(2)自动提交事务</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#查看自动提交事务是否开启</span><br><span class="line">show variables like &apos;autocommit&apos;;</span><br><span class="line"></span><br><span class="line">#如果是关的</span><br><span class="line">set autocommit=0|1</span><br></pre></td></tr></table></figure>
<h2 id="6-索引"><a href="#6-索引" class="headerlink" title="6.索引"></a>6.索引</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">优点:加快了mysql的查找速度</span><br><span class="line">缺点:</span><br><span class="line">1.更多的储存空间来储存索引字段名</span><br><span class="line">2.myisam使得insert,update,delete的速度变慢了(查询操作占用90%,cud操作加起来占用10%的操作还未必能达到)</span><br></pre></td></tr></table></figure>
<h3 id="1-创建索引的原则"><a href="#1-创建索引的原则" class="headerlink" title="(1)创建索引的原则"></a>(1)创建索引的原则</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#适合</span><br><span class="line">1.用于频繁查找的列(字段)</span><br><span class="line">2.用于条件判断的列(字段)</span><br><span class="line">3.用于排序的列(字段)</span><br><span class="line">#不适合</span><br><span class="line">1.列中的数据并不多</span><br><span class="line">2.表中的数据量很小</span><br></pre></td></tr></table></figure>
<h3 id="2-索引的类型"><a href="#2-索引的类型" class="headerlink" title="(2)索引的类型"></a>(2)索引的类型</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.普通索引</span><br><span class="line">create index isex on stuinfo(sex);</span><br><span class="line"></span><br><span class="line">alter table stuinfo add index isname(sname);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2.唯一索引</span><br><span class="line">unique</span><br><span class="line">#创建方法如上</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">3.主键索引</span><br><span class="line">primary key</span><br><span class="line">#创建方法如上</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">4.全文索引</span><br><span class="line">#xunsearch是一种工具</span><br><span class="line"></span><br><span class="line">fulltext key</span><br><span class="line">只能在myisam表引擎下使用(innodb,myisam创建的话都能创建,但是innodb中无效),使用like的时候提升效率.#  where nama like &apos;%你%&apos;;</span><br><span class="line">create FULLTEXT KEY zu on stuinfo(age,city);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">5.创建多列索引(组合索引)</span><br><span class="line">create index zu on stuinfo(age,city);</span><br><span class="line">alter table stuinfo add index isname(sname,city);</span><br></pre></td></tr></table></figure>
<h3 id="3-删除索引"><a href="#3-删除索引" class="headerlink" title="(3)删除索引"></a>(3)删除索引</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop index zu on stuinfo;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#mysql优化</span><br><span class="line"></span><br><span class="line">innodb=&gt;执行 insert(多条) update delete 非常快</span><br><span class="line">myisam=&gt;执行 insert(单次) select  非常快</span><br><span class="line"></span><br><span class="line">1.mysql需要搭建在远程的服务器中</span><br><span class="line">2.1mysql台服务器中的所有表类型全部是innodb,其它4台服务器中的表全市myisam的</span><br><span class="line"></span><br><span class="line">主从复制(一主多从)(双主多从)</span><br><span class="line">master(主的mysql服务器 innodb) IO</span><br><span class="line">#从服务器监听主服务器</span><br><span class="line">slave(从服务器是myisam)  10.11.58.1 () IO</span><br><span class="line">slave(从服务器是myisam)  10.11.58.2</span><br><span class="line">slave(从服务器是myisam)</span><br><span class="line">slave(从服务器是myisam)</span><br><span class="line"></span><br><span class="line">从服务器(myisam)sub监听主服务器</span><br><span class="line"></span><br><span class="line">监听什么?</span><br><span class="line">ip地址</span><br><span class="line">干吗了?</span><br><span class="line">主服务器插入,修改,删除一条,从服务器插入,修改,删除一条.</span><br><span class="line"></span><br><span class="line">从服务器主要是用来查询的.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">innodb 和myisam有什么区别吗?</span><br><span class="line">表文件,数据存储方式不同.</span><br><span class="line">innodb可以使用外键,事务,唯一键</span><br><span class="line">myisam可以使用全文索引</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql怎么优化? IO</span><br><span class="line">添加索引,常用被查询的,数据量大的</span><br><span class="line">分表: 垂直分表和水平分表</span><br><span class="line">垂直分表是分字段</span><br><span class="line">水平分表是分数据的数量</span><br><span class="line"></span><br><span class="line">数据库分库,主从</span><br><span class="line"></span><br><span class="line">硬件方面考虑,固态硬盘比机械强</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://jyue0812.github.io/2018/05/21/MySQL第四课/" data-id="cjhfjx3de0002w4qx0b7jbs4h" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/blog/2018/05/21/MySQL第五课/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/blog/2018/05/21/python基础17/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/04/">April 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2018/05/21/pymysql/">(no title)</a>
          </li>
        
          <li>
            <a href="/blog/2018/05/21/Mysql主从复制/">(no title)</a>
          </li>
        
          <li>
            <a href="/blog/2018/05/21/MySQL第五课/">(no title)</a>
          </li>
        
          <li>
            <a href="/blog/2018/05/21/MySQL第四课/">(no title)</a>
          </li>
        
          <li>
            <a href="/blog/2018/05/21/python基础17/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 ZY<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">Home</a>
  
    <a href="/blog/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css">
  <script src="/blog/fancybox/jquery.fancybox.pack.js"></script>


<script src="/blog/js/script.js"></script>



  </div>
</body>
</html>